<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Select PCO scores — PCOselect • MorphoRegions</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Select PCO scores — PCOselect"><meta name="description" content="PCOselect() provides several methods to select the number of principal coordinates (PCOs) analysis scores to be used in subsequent analyses."><meta property="og:description" content="PCOselect() provides several methods to select the number of principal coordinates (PCOs) analysis scores to be used in subsequent analyses."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MorphoRegions</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/MorphoRegions.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/aagillet/MorphoRegions/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Select PCO scores</h1>
      <small class="dont-index">Source: <a href="https://github.com/aagillet/MorphoRegions/blob/master/R/PCOselect.R" class="external-link"><code>R/PCOselect.R</code></a></small>
      <div class="d-none name"><code>PCOselect.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>PCOselect()</code> provides several methods to select the number of principal coordinates (PCOs) analysis scores to be used in subsequent analyses.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">PCOselect</span><span class="op">(</span></span>
<span>  <span class="va">pco</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"manual"</span>,</span>
<span>  scores <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cutoff <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  nreps <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  results <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  criterion <span class="op">=</span> <span class="st">"aic"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'regions_pco_select'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'regions_pco_select'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-pco">pco<a class="anchor" aria-label="anchor" href="#arg-pco"></a></dt>
<dd><p>a <code>regions_pco</code> object; the output of a call to <code><a href="svdPCO.html">svdPCO()</a></code>.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>string; the method used to select the number of PCOs. Allowable options include <code>"manual"</code>, <code>"boot"</code>, <code>"variance"</code>, and <code>"max"</code>. Default is <code>"manual"</code>. Abbreviations allowed. See Details.</p></dd>


<dt id="arg-scores">scores<a class="anchor" aria-label="anchor" href="#arg-scores"></a></dt>
<dd><p>when <code>method = "manual"</code>, the number of PCO scores to use.</p></dd>


<dt id="arg-cutoff">cutoff<a class="anchor" aria-label="anchor" href="#arg-cutoff"></a></dt>
<dd><p>when <code>method = "variance"</code>, the cutoff for the variance explained by each PCO score.</p></dd>


<dt id="arg-nreps">nreps<a class="anchor" aria-label="anchor" href="#arg-nreps"></a></dt>
<dd><p>when <code>method = "boot"</code>, the number of bootstrap replications to use.</p></dd>


<dt id="arg-results">results<a class="anchor" aria-label="anchor" href="#arg-results"></a></dt>
<dd><p>when <code>method = "max"</code>, a <code>regions_results</code> object, the output of a call to <code><a href="calcregions.html">calcregions()</a></code>.</p></dd>


<dt id="arg-criterion">criterion<a class="anchor" aria-label="anchor" href="#arg-criterion"></a></dt>
<dd><p>when <code>method = "max"</code>, which criterion should be used to select the number of scores. Allowable options include <code>"aic"</code> and <code>"bic"</code>. Abbreviations allowed.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>when <code>method = "boot"</code>, whether to display a progress bar. Default is <code>TRUE</code>.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>for <code>plot.regions_pco_select()</code>, a <code>regions_pco_select</code> object, the output of a call to <code>PCOselect()</code> with <code>method = "boot"</code> or <code>"max"</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>ignored.</p></dd>


<dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>a <code>regions_pco_select</code> object, the output of a call to <code>PCOselect()</code> with <code>method = "max"</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>For <code>PCOselect()</code>, a <code>regions_pco_select</code> object, which is a numeric vector containing the indices of the chosen PCOs, with attributes containing information about the PCO scores chosen by the specified method. When <code>method = "boot"</code>, the bootstrap results are stored in the <code>"boot"</code> attribute. When <code>method = "max"</code>, the <code>regions_results</code> object passed to <code>regions</code> and other information about the quality of fit for each number of PCOs are stored in the <code>"pcomax"</code> attribute.</p>
<p>The <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> methods each return a <code>ggplot</code> object that can manipulated using <span class="pkg">ggplot2</span> syntax. The <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method returns a data.frame of results.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Each method provides an alternate way to select the number of scores. These are described below.</p><div class="section">
<h3 id="method-manual-"><code>method = "manual"</code>:<a class="anchor" aria-label="anchor" href="#method-manual-"></a></h3>


<p>This simply returns the number supplied to <code>scores</code> after running some checks to ensure it is valid.</p>
</div>

<div class="section">
<h3 id="method-boot-"><code>method = "boot"</code><a class="anchor" aria-label="anchor" href="#method-boot-"></a></h3>


<p>Bootstrapping works by comparing the eigenvalue distributions of PCOs to those with randomized data in order to extract PCO axes with significant signal, which are defined as those with eigenvalues greater than those from randomized data. The returned PCO cutoff is the largest PCO axis whose eigenvalues fall below the mean eigenvalue for that axis from the randomized data. Data are randomly sampled by row. Bootstrapping is sensitive to unequal variances of columns, so <code>scale = TRUE</code> should be set in the call to <code><a href="svdPCO.html">svdPCO()</a></code>, which is the default; the data are scaled in the same way prior to bootstrapping. The <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method displays the eigenvalues of the true PCOs and boxplots summarizing the distribution of the bootstrapped eigenvalues for each PCO.</p>
</div>

<div class="section">
<h3 id="method-variance-"><code>method = "variance"</code><a class="anchor" aria-label="anchor" href="#method-variance-"></a></h3>


<p>This method works by computing the ratio of each eigenvalue to the sum of the eigenvalues (i.e., to compute the proportion of variance explained by each PCO score) and select the number of scores with ratios greater than the cutoff value supplied to <code>cutoff</code>.</p>
</div>

<div class="section">
<h3 id="method-max-"><code>method = "max"</code><a class="anchor" aria-label="anchor" href="#method-max-"></a></h3>


<p>This method works by selecting the smallest number of PCOs that gives a region score within .001 of the maximum possible region score for the segmented models fit in the object supplied to <code>results</code>. Which criterion is maximized (AIC or BIC) is determined by the value supplied to <code>criterion</code>. The <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method displays the region score (estimated number of regions) for each PCO (<code>RSind</code>) and for PCOs cumulatively (<code>RScum</code>) selected using the AICc or BIC as well as the cumulative proportion of variance explained by the PCOs. The <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method displays this information graphically, with the left y-axis displaying the region score for the PCOs individually (pale blue triangles) and cumulatively (orange circles) using each of the two criteria, and the right y-axis displaying the cumulative percentage of variance explained by the PCOs.</p>
</div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"alligator"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">alligator_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="process_measurements.html">process_measurements</a></span><span class="op">(</span><span class="va">alligator</span>,</span></span>
<span class="r-in"><span>                                       pos <span class="op">=</span> <span class="st">"Vertebra"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compute PCOs</span></span></span>
<span class="r-in"><span><span class="va">alligator_PCO</span> <span class="op">&lt;-</span> <span class="fu"><a href="svdPCO.html">svdPCO</a></span><span class="op">(</span><span class="va">alligator_data</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Select which PCOs to use</span></span></span>
<span class="r-in"><span><span class="co">## Manually (first 4 PCOs)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">PCOs</span> <span class="op">&lt;-</span> <span class="fu">PCOselect</span><span class="op">(</span><span class="va">alligator_PCO</span>, <span class="st">"manual"</span>, scores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A `regions_pco_select` object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - PCO scores selected: 1, 2, 3, 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Method: manual</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Using variance cutoff: PCOs that explain 5% or more</span></span></span>
<span class="r-in"><span><span class="co">## of total PCO variance</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">PCOs</span> <span class="op">&lt;-</span> <span class="fu">PCOselect</span><span class="op">(</span><span class="va">alligator_PCO</span>, <span class="st">"variance"</span>, cutoff <span class="op">=</span> <span class="fl">.05</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A `regions_pco_select` object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - PCO scores selected: 1, 2, 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Method: variance (cutoff: 0.05)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Using bootstrapping with 50 reps (more reps should</span></span></span>
<span class="r-in"><span><span class="co">## be used in practice; default is fine)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">PCOs</span> <span class="op">&lt;-</span> <span class="fu">PCOselect</span><span class="op">(</span><span class="va">alligator_PCO</span>, <span class="st">"boot"</span>, nreps <span class="op">=</span> <span class="fl">50</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bootstrapping...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A `regions_pco_select` object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - PCO scores selected: 1, 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Method: boot (50 replications)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">PCOs</span><span class="op">)</span> <span class="co">#plot true eigenvalues against bootstrapped</span></span></span>
<span class="r-plt img"><img src="PCOselect-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Using PCOs that optimize region score:</span></span></span>
<span class="r-in"><span><span class="va">regionresults</span> <span class="op">&lt;-</span> <span class="fu"><a href="calcregions.html">calcregions</a></span><span class="op">(</span><span class="va">alligator_PCO</span>, scores <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">21</span>, noregions <span class="op">=</span> <span class="fl">7</span>,</span></span>
<span class="r-in"><span>                             minvert <span class="op">=</span> <span class="fl">3</span>, cont <span class="op">=</span> <span class="cn">TRUE</span>, exhaus <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                             verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">PCOs</span> <span class="op">&lt;-</span> <span class="fu">PCOselect</span><span class="op">(</span><span class="va">alligator_PCO</span>, <span class="st">"max"</span>,</span></span>
<span class="r-in"><span>                   results <span class="op">=</span> <span class="va">regionresults</span>,</span></span>
<span class="r-in"><span>                   criterion <span class="op">=</span> <span class="st">"bic"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A `regions_pco_select` object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - PCO scores selected: 1, 2, 3, 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Method: max (criterion: BIC)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">PCOs</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="PCOselect-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">PCOs</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  PCO RSind.AICc RScum.AICc RSind.BIC RScum.BIC CumulVar</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1      3.636      3.636     4.539     4.539    0.528</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2      3.277      4.511     4.018     4.825    0.756</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3      4.963      5.000     5.044     5.001    0.864</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4      2.960      5.411     3.822     5.613    0.892</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5      1.112      5.228     1.124     5.195    0.912</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    6      3.963      5.652     4.068     5.348    0.930</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    7      1.212      5.481     1.217     5.081    0.943</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    8      1.164      5.409     1.168     5.020    0.952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    9      1.084      5.132     1.083     5.000    0.960</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   10      1.108      5.031     1.097     4.987    0.968</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   11      1.063      5.009     1.054     4.921    0.974</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   12      1.091      5.003     1.078     4.530    0.980</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   13      1.073      5.001     1.072     3.545    0.985</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   14      1.065      5.000     1.056     3.136    0.990</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   15      1.062      5.000     1.052     3.031    0.993</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   16      1.072      5.000     1.062     3.012    0.995</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   17      1.059      5.000     1.050     3.004    0.997</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   18      1.064      5.000     1.055     3.001    0.998</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   19      1.089      5.000     1.085     3.001    0.999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   20      1.075      5.000     1.069     3.000    1.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   21      1.081      5.000     1.069     3.000    1.000</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Amandine Gillet, Katrina Jones, Noah Greifer, Stephanie Pierce.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

