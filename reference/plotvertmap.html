<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot a vertebra map — plotvertmap • MorphoRegions</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot a vertebra map — plotvertmap"><meta name="description" content="plotvertmap() plots a map of the supplied vertebrae, optionally adding colors, marks, and text to identify existing and estimated features of the vertebrae."><meta property="og:description" content="plotvertmap() plots a map of the supplied vertebrae, optionally adding colors, marks, and text to identify existing and estimated features of the vertebrae."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MorphoRegions</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/MorphoRegions.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/aagillet/MorphoRegions/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot a vertebra map</h1>
      <small class="dont-index">Source: <a href="https://github.com/aagillet/MorphoRegions/blob/master/R/plotvertmap.R" class="external-link"><code>R/plotvertmap.R</code></a></small>
      <div class="d-none name"><code>plotvertmap.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>plotvertmap()</code> plots a map of the supplied vertebrae, optionally adding colors, marks, and text to identify existing and estimated features of the vertebrae.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotvertmap</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"count"</span>,</span>
<span>  bps <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  modelsupport <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  criterion <span class="op">=</span> <span class="st">"aic"</span>,</span>
<span>  model <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  bpvar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bp.sd <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sd.col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  dropNA <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  text <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  centraL <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  reg.lim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lim.col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  block.cols <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  block.lim <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a <code>regions_data</code>, <code>regions_pco</code>, or <code>regions_sim</code> object; the output of a call to <code><a href="process_measurements.html">process_measurements()</a></code>, <code><a href="svdPCO.html">svdPCO()</a></code>, or <code><a href="simregions.html">simregions()</a></code>, respectively.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>string; the labeling of the x-axis of the plot. Either <code>"count"</code> to identify the vertebra index (or absolute position when <code>centraL</code> is supplied) or <code>"percent"</code> to identify the percent vertebra count (or percent total length when <code>centraL</code> is supplied). Abbreviations allowed. Default is <code>"count"</code>.</p></dd>


<dt id="arg-bps">bps<a class="anchor" aria-label="anchor" href="#arg-bps"></a></dt>
<dd><p>an optional vector containing the region breakpoints. One of <code>bps</code>, <code>modelsupport</code>, or <code>bpvar</code> should be specified to display regions breakpoints. See Details.</p></dd>


<dt id="arg-modelsupport">modelsupport<a class="anchor" aria-label="anchor" href="#arg-modelsupport"></a></dt>
<dd><p>an optional <code>regions_modelsupport</code> object; the output of a call to <code><a href="modelsupport.html">modelsupport()</a></code>. One of <code>bps</code>, <code>modelsupport</code>, or <code>bpvar</code> should be specified to display regions breakpoints. See Details.</p></dd>


<dt id="arg-criterion">criterion<a class="anchor" aria-label="anchor" href="#arg-criterion"></a></dt>
<dd><p>string; the criterion to use to select the best model for which breakpoints are to be displayed when <code>modelsupport</code> is specified. Ignored otherwise. Allowable options include <code>"aic"</code> to use the AICc and <code>"bic"</code> to use the BIC. Abbreviations allowed. Default is <code>"aic"</code>.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p><code>numeric</code>; from which model among the best as determined by <code>criterion</code> should breakpoints be selected when <code>modelsupport</code> is supplied. Ignored otherwise. 1 is the best model, 2 the second best, etc. Default is 1.</p></dd>


<dt id="arg-bpvar">bpvar<a class="anchor" aria-label="anchor" href="#arg-bpvar"></a></dt>
<dd><p>an optional <code>regions_BPvar</code> object; the output of a call to <code><a href="calcBPvar.html">calcBPvar()</a></code>. One of <code>bps</code>, <code>modelsupport</code>, or <code>bpvar</code> should be specified to display regions breakpoints. See Details.</p></dd>


<dt id="arg-bp-sd">bp.sd<a class="anchor" aria-label="anchor" href="#arg-bp-sd"></a></dt>
<dd><p>an optional vector of the standard deviations of the breakpoints (e.g., as calculated by <code><a href="calcBPvar.html">calcBPvar()</a></code>). When <code>bpvar</code> is supplied, the weighted standard deviations are used.</p></dd>


<dt id="arg-sd-col">sd.col<a class="anchor" aria-label="anchor" href="#arg-sd-col"></a></dt>
<dd><p>when <code>bp.sd</code> is specified, the color of the mark on plot indicating the standard deviations. Default is black.</p></dd>


<dt id="arg-dropna">dropNA<a class="anchor" aria-label="anchor" href="#arg-dropna"></a></dt>
<dd><p><code>logical</code>; when some vertebrae are missing, e.g., due to subsampling or starting the analysis at a vertebra beyond the first, whether to remove the missing vertebrae from the plot (<code>TRUE</code>) or retain them and label them as missing (i.e., lacking a region) (<code>FALSE</code>). Default is <code>FALSE</code> to retain them.</p></dd>


<dt id="arg-text">text<a class="anchor" aria-label="anchor" href="#arg-text"></a></dt>
<dd><p><code>logical</code>; whether to print the vertebra index on each vertebra. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-name">name<a class="anchor" aria-label="anchor" href="#arg-name"></a></dt>
<dd><p>an optional string containing a label used on the left side of the plot.</p></dd>


<dt id="arg-central">centraL<a class="anchor" aria-label="anchor" href="#arg-central"></a></dt>
<dd><p>an optional numeric vector containing centrum length for each vertebra, which is used to change the size of the plotted vertebrae, or a string containing the name of the variable in the original dataset containing centrum length. Should be of length equal to the number of included vertebrae (i.e., the length of the original dataset). Any vertebrae with centrum length of 0 will be omitted.</p></dd>


<dt id="arg-reg-lim">reg.lim<a class="anchor" aria-label="anchor" href="#arg-reg-lim"></a></dt>
<dd><p>a vector of breakpoints indicating other region limits, e.g., anatomic regions.</p></dd>


<dt id="arg-lim-col">lim.col<a class="anchor" aria-label="anchor" href="#arg-lim-col"></a></dt>
<dd><p>when <code>reg.lim</code> is specified, the color of the lines separating the regions. Default is black.</p></dd>


<dt id="arg-block-cols">block.cols<a class="anchor" aria-label="anchor" href="#arg-block-cols"></a></dt>
<dd><p>when breakpoints are specified (i.e., using <code>bps</code>, <code>modelsupport</code>, or <code>bpvar</code>) and <code>block.lim</code> is not specified, a vector of color names or hex codes, one for each region. If not specified, <code><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">RColorBrewer::brewer.pal()</a></code> with <code>name = "paired"</code> will be used to generate colors. When <code>block.lim</code> is specified, a named list of vectors of color names or hex codes. See Details.</p></dd>


<dt id="arg-block-lim">block.lim<a class="anchor" aria-label="anchor" href="#arg-block-lim"></a></dt>
<dd><p>a vector of breakpoints indicating the limits of traditional regions, which will be colored using <code>block.cols</code>. See Details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>ggplot</code> object that can be manipulated using <code>ggplot2</code> syntax.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>plotvertmap()</code> uses <code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">ggplot2::geom_rect()</a></code> to create the plot. The plots are best viewed with a short height and a long width.</p><div class="section">
<h3 id="specifying-breakpoints-">Specifying breakpoints:<a class="anchor" aria-label="anchor" href="#specifying-breakpoints-"></a></h3>


<p>There are three ways to specify regions in <code>plotvertmap()</code>. First is to supply the vector of breakpoints directly to <code>bps</code>. Second is to supply a <code>regions_modelsupport</code> object to <code>modelsupport</code>. When supplied, the <code>criterion</code> and <code>model</code> arguments can be used to select which of the sets of breakpoints in the object is to be used. <code>model</code> selects which breakpoint model is to be used (1 for first best, 2 for second best, etc.), and <code>criterion</code> determines which criterion (AICc or BIC) is used to rank the models. Third is to supply <code> regions_BPvar</code> object to <code>bpvar</code>. The weighted average breakpoints will be used after rounding (e.g., a weighted average breakpoint of 3.3 will place vertebrae 1, 2, and 3 in a region, and a weighted average breakpoint of 3.9 will place vertebrae 1, 2, 3, and 4 in a region).</p>
</div>

<div class="section">
<h3 id="using-block-cols-">Using <code>block.cols</code>:<a class="anchor" aria-label="anchor" href="#using-block-cols-"></a></h3>


<p>When <code>block.lim</code> is specified, <code>block.cols</code> must be specified as a list of vectors of colors, with an entry for each "block". Blocks are predefined regions separate from those specified using the above arguments, e.g., traditional regions. For each region, the most common block is found and assigned to that region. A color of that block as supplied in <code>block.cols</code> is used to color that region. So, each block needs as many colors as there are regions assigned to it. For example, if regions 1 and 2 are both assigned to block 1 (i.e., because block 1 is the most common block in those regions), the entry in <code>block.cols</code> for that block must have (at least) 2 colors. If an incorrect number of colors per block is supplied, an error will be thrown identifying which blocks are lacking colors. See Examples.</p>
</div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"alligator"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">alligator_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="process_measurements.html">process_measurements</a></span><span class="op">(</span><span class="va">alligator</span>,</span></span>
<span class="r-in"><span>                                       pos <span class="op">=</span> <span class="st">"Vertebra"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compute PCOs</span></span></span>
<span class="r-in"><span><span class="va">alligator_PCO</span> <span class="op">&lt;-</span> <span class="fu"><a href="svdPCO.html">svdPCO</a></span><span class="op">(</span><span class="va">alligator_data</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot vertebral map with specified breakpoints</span></span></span>
<span class="r-in"><span><span class="fu">plotvertmap</span><span class="op">(</span><span class="va">alligator_PCO</span>,</span></span>
<span class="r-in"><span>            type <span class="op">=</span> <span class="st">"percent"</span>,</span></span>
<span class="r-in"><span>            name <span class="op">=</span> <span class="st">"Alligator"</span>,</span></span>
<span class="r-in"><span>            bps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">15</span>, <span class="fl">19</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            text <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotvertmap-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit segmented regression models for 1 to 7 regions</span></span></span>
<span class="r-in"><span><span class="co"># using PCOs 1 to 4 and a continuous model with a</span></span></span>
<span class="r-in"><span><span class="co"># exhaustive search</span></span></span>
<span class="r-in"><span><span class="va">regionresults</span> <span class="op">&lt;-</span> <span class="fu"><a href="calcregions.html">calcregions</a></span><span class="op">(</span><span class="va">alligator_PCO</span>,</span></span>
<span class="r-in"><span>                             scores <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,</span></span>
<span class="r-in"><span>                             noregions <span class="op">=</span> <span class="fl">7</span>,</span></span>
<span class="r-in"><span>                             minvert <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                             cont <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                             exhaus <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                             verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># For each number of regions, identify best</span></span></span>
<span class="r-in"><span><span class="co"># model based on minimizing RSS</span></span></span>
<span class="r-in"><span><span class="va">bestresults</span> <span class="op">&lt;-</span> <span class="fu"><a href="modelselect.html">modelselect</a></span><span class="op">(</span><span class="va">regionresults</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Evaluate support for each model and rank models</span></span></span>
<span class="r-in"><span><span class="va">supp</span> <span class="op">&lt;-</span> <span class="fu"><a href="modelsupport.html">modelsupport</a></span><span class="op">(</span><span class="va">bestresults</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot vertebral map with breakpoints corresponding to</span></span></span>
<span class="r-in"><span><span class="co"># best segmented regression model as determined by</span></span></span>
<span class="r-in"><span><span class="co"># AICc</span></span></span>
<span class="r-in"><span><span class="fu">plotvertmap</span><span class="op">(</span><span class="va">alligator_PCO</span>,</span></span>
<span class="r-in"><span>            type <span class="op">=</span> <span class="st">"percent"</span>,</span></span>
<span class="r-in"><span>            name <span class="op">=</span> <span class="st">"Alligator"</span>,</span></span>
<span class="r-in"><span>            modelsupport <span class="op">=</span> <span class="va">supp</span>,</span></span>
<span class="r-in"><span>            model <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>            criterion <span class="op">=</span> <span class="st">"aic"</span>,</span></span>
<span class="r-in"><span>            text <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotvertmap-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot vertebral map with breakpoints corresponding to</span></span></span>
<span class="r-in"><span><span class="co"># best segmented regression model as determined by</span></span></span>
<span class="r-in"><span><span class="co"># AICc, using centrum length to size vertebrae</span></span></span>
<span class="r-in"><span><span class="fu">plotvertmap</span><span class="op">(</span><span class="va">alligator_PCO</span>,</span></span>
<span class="r-in"><span>            name <span class="op">=</span> <span class="st">"Alligator"</span>,</span></span>
<span class="r-in"><span>            modelsupport <span class="op">=</span> <span class="va">supp</span>,</span></span>
<span class="r-in"><span>            model <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>            criterion <span class="op">=</span> <span class="st">"aic"</span>,</span></span>
<span class="r-in"><span>            centraL <span class="op">=</span> <span class="st">"CL"</span>,</span></span>
<span class="r-in"><span>            text <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotvertmap-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compute Akaike-weighted location and SD of optimal</span></span></span>
<span class="r-in"><span><span class="co"># breakpoints using top 10% of models with 4 regions</span></span></span>
<span class="r-in"><span><span class="va">bpvar</span> <span class="op">&lt;-</span> <span class="fu"><a href="calcBPvar.html">calcBPvar</a></span><span class="op">(</span><span class="va">regionresults</span>, noregions <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>                   pct <span class="op">=</span> <span class="fl">.1</span>, criterion <span class="op">=</span> <span class="st">"aic"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Using weighted BPs and SDs from calcBPvar()</span></span></span>
<span class="r-in"><span><span class="fu">plotvertmap</span><span class="op">(</span><span class="va">alligator_PCO</span>, name <span class="op">=</span> <span class="st">"Dolphin"</span>,</span></span>
<span class="r-in"><span>            bpvar <span class="op">=</span> <span class="va">bpvar</span>,</span></span>
<span class="r-in"><span>            text <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotvertmap-4.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Amandine Gillet, Katrina Jones, Noah Greifer, Stephanie Pierce.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

